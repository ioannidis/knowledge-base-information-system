package eu.ioannidis.vulnerabilityservice.models.entities;

import eu.ioannidis.vulnerabilityservice.utils.enums.StatusEnum;
import org.hibernate.annotations.GenericGenerator;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import javax.persistence.*;
import java.util.Date;
import java.util.UUID;

@Entity
@Table(name = "vulnerabilities")
@EntityListeners(AuditingEntityListener.class)
public class VulnerabilityEntity extends BaseEntity {

    @Id
    @GeneratedValue(generator = "UUID")
    @GenericGenerator(
            name = "UUID",
            strategy = "org.hibernate.id.UUIDGenerator"
    )
    @Column(name = "id")
    private UUID id;

    @Enumerated(value=EnumType.STRING)
    @Column(name = "status")
    private StatusEnum status;

    @Column(name = "cvss")
    private String cvss;

    @Column(name = "report_id")
    private String systemReportId;

    @Column(name = "title")
    private String title;

    @Column(name = "description")
    private String description;

    @Column(name = "refs")
    private String references;

    @Column(name = "action")
    private String action;

    @Column(name = "author_id")
    private UUID author;

    @Column(name = "product_id")
    private UUID product;

    @Column(name = "system_id")
    private UUID system;

    @Column(name = "oem_id")
    private UUID oem;

    @Column(name = "solution")
    private String solution;

    @Column(name = "enabled")
    private boolean enabled;

    public VulnerabilityEntity() {
    }

    public VulnerabilityEntity(UUID id, StatusEnum status, String cvss, String systemReportId, String title, String description, String references, String action, UUID author, UUID product, UUID system, UUID oem, String solution, boolean enabled, Date createdAt, Date modifiedAt) {
        super(createdAt, modifiedAt);
        this.id = id;
        this.status = status;
        this.cvss = cvss;
        this.systemReportId = systemReportId;
        this.title = title;
        this.description = description;
        this.references = references;
        this.action = action;
        this.author = author;
        this.product = product;
        this.system = system;
        this.oem = oem;
        this.solution = solution;
        this.enabled = enabled;
    }

    public UUID getId() {
        return id;
    }

    public void setId(UUID id) {
        this.id = id;
    }

    public StatusEnum getStatus() {
        return status;
    }

    public void setStatus(StatusEnum status) {
        this.status = status;
    }

    public String getCvss() {
        return cvss;
    }

    public void setCvss(String cvss) {
        this.cvss = cvss;
    }

    public String getSystemReportId() {
        return systemReportId;
    }

    public void setSystemReportId(String systemReportId) {
        this.systemReportId = systemReportId;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getReferences() {
        return references;
    }

    public void setReferences(String references) {
        this.references = references;
    }

    public String getAction() {
        return action;
    }

    public void setAction(String action) {
        this.action = action;
    }

    public UUID getAuthor() {
        return author;
    }

    public void setAuthor(UUID author) {
        this.author = author;
    }

    public UUID getProduct() {
        return product;
    }

    public void setProduct(UUID product) {
        this.product = product;
    }

    public UUID getSystem() {
        return system;
    }

    public void setSystem(UUID system) {
        this.system = system;
    }

    public UUID getOem() {
        return oem;
    }

    public void setOem(UUID oem) {
        this.oem = oem;
    }

    public String getSolution() {
        return solution;
    }

    public void setSolution(String solution) {
        this.solution = solution;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void setEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    @Override
    public String toString() {
        return "VulnerabilityEntity{" +
                "id=" + id +
                ", status=" + status +
                ", cvss='" + cvss + '\'' +
                ", systemReportId='" + systemReportId + '\'' +
                ", title='" + title + '\'' +
                ", description='" + description + '\'' +
                ", references='" + references + '\'' +
                ", action='" + action + '\'' +
                ", author=" + author +
                ", product=" + product +
                ", system=" + system +
                ", oem=" + oem +
                ", solution='" + solution + '\'' +
                ", enabled=" + enabled +
                '}';
    }
}
